<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Today I learned about mso-generic-font-family…</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Today I learned about mso-generic-font-family…</h1>
</header>
<section data-field="subtitle" class="p-summary">
And solved a twelve years old Outlook mystery along the way.
</section>
<section data-field="body" class="e-content">
<section name="c255" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d5a8" id="d5a8" class="graf graf--h3 graf--leading graf--title">Today I learned about mso-generic-font-family…</h3><h4 name="1a39" id="1a39" class="graf graf--h4 graf-after--h3 graf--subtitle">And solved a twelve years old Outlook mystery along the way.</h4><p name="da94" id="da94" class="graf graf--p graf-after--h4">This morning I was doing some tests in Outlook on supported styles for HTML lists. And my focus quickly diverged to something completely unrelated. Using <a href="http://whatdoesitpaste.com/" data-href="http://whatdoesitpaste.com/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">What does it paste</em></a> for the first time to get the code generated by Outlook and its Word powered rendering engine, the <code class="markup--code markup--p-code">&lt;head&gt;</code> of the code contained the following:</p><pre name="9cab" id="9cab" class="graf graf--pre graf-after--p">&lt;style&gt; &lt;!-- /* Font Definitions */<br>@font-face {<br> font-family:Calibri;<br> panose-1:2 15 5 2 2 2 4 3 2 4;<br> mso-font-charset:0;<br> mso-generic-font-family:swiss;<br> mso-font-pitch:variable;<br> mso-font-signature:-536859905 -1073732485 9 0 511 0;<br>}<br>&lt;/style&gt;</pre><p name="919b" id="919b" class="graf graf--p graf-after--pre"><code class="markup--code markup--p-code">@font-face</code>? In Outlook? How can that be?</p><p name="3114" id="3114" class="graf graf--p graf-after--p">If you’re familiar with web fonts in emails, you know there’s a notorious bug in <em class="markup--em markup--p-em">the Outlooks</em> (2007, 2010, 2013 and 2016) on Windows. Whenever you would import a web font using a <code class="markup--code markup--p-code">@font-face</code> declaration, Outlook would (as one can expect) disregard it. But Outlook would also disregard the font stack declared in your styles, forcing all texts using that web font to Times New Roman. Take the following example:</p><pre name="55f5" id="55f5" class="graf graf--pre graf-after--p">&lt;!doctype html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br> &lt;title&gt;mso-generic-font-family&lt;/title&gt;<br> &lt;link href=&quot;<a href="https://fonts.googleapis.com/css?family=Pacifico" data-href="https://fonts.googleapis.com/css?family=Pacifico" class="markup--anchor markup--pre-anchor" rel="nofollow noopener" target="_blank">https://fonts.googleapis.com/css?family=Pacifico</a>&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br> &lt;p style=&quot;<strong class="markup--strong markup--pre-strong">font-family:Pacifico, sans-serif;</strong>&quot;&gt;<br>  This is a text set in the &lt;strong&gt;Pacifico&lt;/strong&gt; font.<br> &lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</pre><p name="6f16" id="6f16" class="graf graf--p graf-after--pre">Outlook would irremediably set that text in Times New Roman, ignoring the <code class="markup--code markup--p-code">sans-serif</code> fallback defined in the <code class="markup--code markup--p-code">font-family</code> property.</p><figure name="cce9" id="cce9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 289px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.3%;"></div><img class="graf-image" data-image-id="1*4UEFoZsSKJpG3yTPV8GbxQ.png" data-width="1111" data-height="459" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*4UEFoZsSKJpG3yTPV8GbxQ.png"></div><figcaption class="imageCaption">Tests screenshots from Email on Acid showing the text set in Times New Roman in Outlook 2016.</figcaption></figure><p name="5859" id="5859" class="graf graf--p graf-after--figure">A lot of solutions surfaced through the years to avoid this bug, from <a href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" data-href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">using </a><code class="markup--code markup--p-code"><a href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" data-href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">!important</a></code><a href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" data-href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"> inline</a> to <a href="https://www.campaignmonitor.com/blog/email-marketing/2019/04/using-web-fonts-in-email/" data-href="https://www.campaignmonitor.com/blog/email-marketing/2019/04/using-web-fonts-in-email/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">setting your web font inside a media query</a>. But my favorite has always been to hide the web font inclusion from Outlook using a conditional comment like in the following example.</p><pre name="831b" id="831b" class="graf graf--pre graf-after--p">&lt;!--[if !mso]&gt;&lt;!-- --&gt;<br>&lt;link href=&quot;<a href="https://fonts.googleapis.com/css?family=Pacifico" data-href="https://fonts.googleapis.com/css?family=Pacifico" class="markup--anchor markup--pre-anchor" rel="nofollow noopener noopener" target="_blank">https://fonts.googleapis.com/css?family=Pacifico</a>&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;<br>&lt;!--&lt;![endif]--&gt;</pre><p name="021e" id="021e" class="graf graf--p graf-after--pre">I always felt that this Outlook behavior was very weird, even by Outlook standards. But that solution worked well enough for me that I never bothered digging any further. Plus, that bug was <a href="https://litmus.com/blog/microsoft-outlook-2019-heres-whats-new" data-href="https://litmus.com/blog/microsoft-outlook-2019-heres-whats-new" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">fixed in the latest Outlook 2019</a> release, so that case was closed for me. Or so I thought.</p><p name="ca94" id="ca94" class="graf graf--p graf-after--p">When I saw that <code class="markup--code markup--p-code">@font-face</code> declaration added by Outlook this morning, I knew there was something more to it. The following line especially piqued my interest:</p><pre name="6474" id="6474" class="graf graf--pre graf-after--p">mso-generic-font-family:swiss;</pre><p name="ca05" id="ca05" class="graf graf--p graf-after--pre">I had never ever heard of that property. But that name really sounds like it could play a role in Outlook’s fallback behavior for web fonts.</p><p name="ee8a" id="ee8a" class="graf graf--p graf-after--p">So I took my first test example, declared my web font in an embedded style tag, and added that <code class="markup--code markup--p-code">mso-generic-font-family</code> property.</p><pre name="5c10" id="5c10" class="graf graf--pre graf-after--p">&lt;!doctype html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br> &lt;title&gt;mso-generic-font-family&lt;/title&gt;<br> &lt;style&gt;<br> <a href="http://twitter.com/font" data-href="http://twitter.com/font" class="markup--anchor markup--pre-anchor" title="Twitter profile for @font" rel="noopener" target="_blank">@font</a>-face {<br>   font-family: &#39;Pacifico&#39;;<br>   font-style: normal;<br>   font-weight: 400;<br>   src: local(&#39;Pacifico Regular&#39;), local(&#39;Pacifico-Regular&#39;), url(<a href="https://www.caniemail.com/tests/assets/fonts/pacifico-regular.woff2" data-href="https://www.caniemail.com/tests/assets/fonts/pacifico-regular.woff2" class="markup--anchor markup--pre-anchor" rel="nofollow noopener" target="_blank">https://www.caniemail.com/tests/assets/fonts/pacifico-regular.woff2</a>) format(&#39;woff2&#39;);<br>   <strong class="markup--strong markup--pre-strong">mso-generic-font-family:swiss;</strong><br> }<br> &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br> &lt;p style=&quot;font-family:Pacifico, sans-serif;&quot;&gt;<br>  This is a text set in the &lt;strong&gt;Pacifico&lt;/strong&gt; font.<br> &lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</pre><p name="f117" id="f117" class="graf graf--p graf-after--pre">And voilà!</p><figure name="5fc8" id="5fc8" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 289px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.3%;"></div><img class="graf-image" data-image-id="1*UPlOh0CIdav98xzBZWJjkw.png" data-width="1111" data-height="459" src="https://cdn-images-1.medium.com/max/800/1*UPlOh0CIdav98xzBZWJjkw.png"></div><figcaption class="imageCaption">Tests screenshots from Email on Acid showing the text set in Arial in Outlook 2016.</figcaption></figure><p name="1618" id="1618" class="graf graf--p graf-after--figure">The <code class="markup--code markup--p-code">mso-generic-font-family</code> property accepts the following values:</p><ul class="postList"><li name="51a0" id="51a0" class="graf graf--li graf-after--p"><code class="markup--code markup--li-code">decorative</code></li><li name="3368" id="3368" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">modern</code></li><li name="a672" id="a672" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">roman</code> (akin to serif)</li><li name="c278" id="c278" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">script</code></li><li name="5254" id="5254" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">swiss</code> (akin to sans-serif)</li><li name="8dbd" id="8dbd" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">auto</code> (defined to <code class="markup--code markup--li-code">roman</code> by default)</li></ul><p name="3845" id="3845" class="graf graf--p graf-after--li">This explains it all. Outlook does support <code class="markup--code markup--p-code">@font-face</code> declarations (but doesn’t load distant fonts). Because Outlook can’t display that font, it falls back to its expected <code class="markup--code markup--p-code">mso-generic-font-family</code> value. And because it’s not defined, it falls back to its <code class="markup--code markup--p-code">auto</code> value, matching the <code class="markup--code markup--p-code">roman</code> font family, thus falling back to Times New Roman.</p><p name="4f79" id="4f79" class="graf graf--p graf-after--p graf--trailing">Case solved.</p></div></div></section><section name="0a70" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="e464" id="e464" class="graf graf--p graf--leading">Digging a little bit further through codes generated by Outlook and <a href="https://rodriguezcommaj.com/blog/dial-ed-for-mso" data-href="https://rodriguezcommaj.com/blog/dial-ed-for-mso" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Microsoft’s Office HTML reference</a>, I also stumbled on a property named <code class="markup--code markup--p-code">mso-font-alt</code>. This property allows for even more fine tuning for web fonts fallback in Outlook as it can accept another font name. So if we add the following lines to our <code class="markup--code markup--p-code">@font-face</code> declaration, Outlook will first try to apply the font named in the <code class="markup--code markup--p-code">mso-font-alt</code> property (if it’s installed on the machine) and apply the family defined in <code class="markup--code markup--p-code">mso-generic-font-family</code> otherwise.</p><pre name="766f" id="766f" class="graf graf--pre graf-after--p graf--trailing">mso-generic-font-family: swiss;<br>mso-font-alt: &quot;Century Gothic&quot;;</pre></div></div></section><section name="ac27" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="dc7b" id="dc7b" class="graf graf--p graf--leading">I hope you enjoyed this read as much as I enjoyed doing this research. I’m now wondering if there’s more to <code class="markup--code markup--p-code">@font-face</code> in Outlook than this. Could there be a way to actually get distant fonts loaded in Outlook? Let me know if you know or find out anything about this.</p><blockquote name="c861" id="c861" class="graf graf--blockquote graf-after--p graf--trailing">Want to learn more about emails coding guidelines? I’m hosting <a href="https://www.smashingmagazine.com/smashing-tv/email-coding-guidelines/" data-href="https://www.smashingmagazine.com/smashing-tv/email-coding-guidelines/" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">a webinar on Smashing Magazine</a> next tuesday (July 23rd at 16:00 GMT).</blockquote></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@hteumeuleu" class="p-author h-card">Rémi Parmentier</a> on <a href="https://medium.com/p/85b0e4703079"><time class="dt-published" datetime="2019-07-17T20:56:55.434Z">July 17, 2019</time></a>.</p><p><a href="https://medium.com/@hteumeuleu/today-i-learned-about-mso-generic-font-family-85b0e4703079" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 9, 2020.</p></footer></article></body></html>