---
title:  "Fake background in email"
date:   2017-07-18 21:01:27 +0200
---
<section name="0439" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="20b5" id="20b5" class="graf graf--h3 graf--leading graf--title">Fake background in email</h3><p name="911b" id="911b" class="graf graf--p graf-after--h3">Recently I had to code something similar to the following as a header for a responsive email.</p><figure name="8393" id="8393" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 95px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 13.600000000000001%;"></div><img class="graf-image" data-image-id="1*cxW0BSdAP_oz9SIS12ZzRg.png" data-width="700" data-height="95" src="https://cdn-images-1.medium.com/max/800/1*cxW0BSdAP_oz9SIS12ZzRg.png"></div><figcaption class="imageCaption">A non rectangular logo centered on a striped background.</figcaption></figure><p name="ff3b" id="ff3b" class="graf graf--p graf-after--figure">My first idea was to use a background image for the stripes. But background image support in emails is not that great. Outlook.com only supports the HTML <code class="markup--code markup--p-code">background</code> attribute, which means the image will be repeated horizontally and vertically. The Gmail Android app with a Non Gmail Account (aka <em class="markup--em markup--p-em">GANGA</em>) doesn’t support the CSS <code class="markup--code markup--p-code">background</code> property at all. And in France, webmails of La Poste and Free don’t support background images either.</p><p name="4bcb" id="4bcb" class="graf graf--p graf-after--p">This header design really set the tone of the brand for the rest of the email, so I didn’t want a solution that wouldn’t work on such popular email clients.</p><p name="c514" id="c514" class="graf graf--p graf-after--p">This gave me the opportunity to try a new technique to make fake background in emails, without actually using any background property.</p><h3 name="0743" id="0743" class="graf graf--h3 graf-after--p">The technique</h3><p name="296e" id="296e" class="graf graf--p graf-after--h3">The inspiration came from an article written last year by Mark Robbins explaining <a href="http://blog.gorebel.com/absolute-positioning-in-email/" data-href="http://blog.gorebel.com/absolute-positioning-in-email/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">how to fake absolute positioning in email</a>. Mark’s idea revolves around using a parent element with a <code class="markup--code markup--p-code">width</code> and <code class="markup--code markup--p-code">height</code> of zero, and then positioning children elements with <code class="markup--code markup--p-code">margin</code> properties.</p><pre name="1be7" id="1be7" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">&lt;div style=&quot;max-height:0; max-width:0; overflow:visible;&quot;&gt;<br>    &lt;div style=&quot;display:inline-block; width:100px; height:100px; margin-top:100px; margin-left:100px;&quot;&gt;…&lt;/div&gt;<br>&lt;/div&gt;</code></pre><p name="d637" id="d637" class="graf graf--p graf-after--pre">This is very interesting because a background image is actually very similar to an image positioned absolutely below another content.</p><p name="31e9" id="31e9" class="graf graf--p graf-after--p">So I started to recreate the design of the stripes. Because it is very simple looking, I could do it using only HTML and CSS by stacking <code class="markup--code markup--p-code">&lt;div&gt;</code> elements with a fixed height and a background color.</p><pre name="b93e" id="b93e" class="graf graf--pre graf-after--p">&lt;div style=&quot;height:5px; background:#3b5998;&quot;&gt;&lt;/div&gt;<br>&lt;div style=&quot;height:5px; background:#fff;&quot;&gt;&lt;/div&gt;<br>&lt;div style=&quot;height:5px; background:#3b5998;&quot;&gt;&lt;/div&gt;<br>&lt;div style=&quot;height:5px; background:#fff;&quot;&gt;&lt;/div&gt;<br>&lt;div style=&quot;height:5px; background:#3b5998;&quot;&gt;&lt;/div&gt;<br>&lt;div style=&quot;height:5px; background:#fff;&quot;&gt;&lt;/div&gt;<br>&lt;div style=&quot;height:5px; background:#3b5998;&quot;&gt;&lt;/div&gt;</pre><p name="418a" id="418a" class="graf graf--p graf-after--pre">Then I wrapped all this with a parent element with an height of zero.</p><pre name="a578" id="a578" class="graf graf--pre graf-after--p">&lt;div style=&quot;height:0;&quot;&gt;<br>   …<br>&lt;/div&gt;</pre><p name="6a8c" id="6a8c" class="graf graf--p graf-after--pre">And at last I placed my content (with the logo image) right after that. And voilà! Here’s a fake background without any background property.</p><pre name="6165" id="6165" class="graf graf--pre graf-after--p">&lt;div style=&quot;height:0;&quot;&gt;<br>    &lt;div style=&quot;height:5px; background:#3b5998;&quot;&gt;&lt;/div&gt;<br>    &lt;div style=&quot;height:5px; background:#fff;&quot;&gt;&lt;/div&gt;<br>    &lt;div style=&quot;height:5px; background:#3b5998;&quot;&gt;&lt;/div&gt;<br>    &lt;div style=&quot;height:5px; background:#fff;&quot;&gt;&lt;/div&gt;<br>    &lt;div style=&quot;height:5px; background:#3b5998;&quot;&gt;&lt;/div&gt;<br>    &lt;div style=&quot;height:5px; background:#fff;&quot;&gt;&lt;/div&gt;<br>    &lt;div style=&quot;height:5px; background:#3b5998;&quot;&gt;&lt;/div&gt;<br>&lt;/div&gt;<br>&lt;img src=&quot;logo.png&quot; alt=&quot;Hello world&quot; /&gt;</pre><p name="cc0c" id="cc0c" class="graf graf--p graf-after--pre">As usual, in the email world, we need a little bit more work to get the best support on email clients. The first problems rise on Yahoo.</p><h4 name="68e0" id="68e0" class="graf graf--h4 graf-after--p">Yahoo support</h4><p name="339b" id="339b" class="graf graf--p graf-after--h4">The desktop webmail of Yahoo <a href="https://github.com/hteumeuleu/email-bugs/issues/9" data-href="https://github.com/hteumeuleu/email-bugs/issues/9" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">replaces the </a><code class="markup--code markup--p-code"><a href="https://github.com/hteumeuleu/email-bugs/issues/9" data-href="https://github.com/hteumeuleu/email-bugs/issues/9" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">height</a></code><a href="https://github.com/hteumeuleu/email-bugs/issues/9" data-href="https://github.com/hteumeuleu/email-bugs/issues/9" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"> property by </a><code class="markup--code markup--p-code"><a href="https://github.com/hteumeuleu/email-bugs/issues/9" data-href="https://github.com/hteumeuleu/email-bugs/issues/9" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">min-height</a></code>. This is pretty annoying because our <code class="markup--code markup--p-code">height:0</code> now becomes <code class="markup--code markup--p-code">min-height:0</code>, which has the same effect as leaving the element takes the height of its content. A solution to prevent this is to use <code class="markup--code markup--p-code">max-height</code> instead.</p><pre name="b6af" id="b6af" class="graf graf--pre graf-after--p">&lt;div style=&quot;max-height:0;&quot;&gt;<br>   …<br>&lt;/div&gt;</pre><p name="51ee" id="51ee" class="graf graf--p graf-after--pre">But Yahoo has <a href="https://github.com/hteumeuleu/email-bugs/issues/17" data-href="https://github.com/hteumeuleu/email-bugs/issues/17" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">another bug</a> that occurs when using <code class="markup--code markup--p-code">max-width</code> or <code class="markup--code markup--p-code">max-height</code> properties. It will automatically add an <code class="markup--code markup--p-code">overflow-x:auto</code> and an <code class="markup--code markup--p-code">overflow-y:auto</code> to the same element. The most visible downside of this is that scrollbars appear as the content overflows the element. A solution to prevent this is to add an <code class="markup--code markup--p-code">overflow:visible</code> at the end of the styles.</p><p name="4a7a" id="4a7a" class="graf graf--p graf-after--p">But on Internet Explorer, Yahoo also adds the prefixed versions of the overflow properties, <code class="markup--code markup--p-code">-ms-overflow-x:auto</code> and <code class="markup--code markup--p-code">-ms-overflow-y:auto</code>. And these declarations will override our own <code class="markup--code markup--p-code">overflow:visible</code>. The solution is to add an <code class="markup--code markup--p-code">!important</code> suffix. So here’s our final code to work on Yahoo.</p><pre name="071e" id="071e" class="graf graf--pre graf-after--p">&lt;div style=&quot;max-height:0; overflow:visible !important;&quot;&gt;<br>   …<br>&lt;/div&gt;</pre><p name="c369" id="c369" class="graf graf--p graf-after--pre">(Note that this <code class="markup--code markup--p-code">overflow</code> bug is no longer present on the new Yahoo webmail UI.)</p><figure name="9b6a" id="9b6a" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 222px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 31.7%;"></div><img class="graf-image" data-image-id="1*9wZxgjPG2QSd-cEgku117A.jpeg" data-width="1263" data-height="400" src="https://cdn-images-1.medium.com/max/800/1*9wZxgjPG2QSd-cEgku117A.jpeg"></div><figcaption class="imageCaption">The fake background working in Yahoo on IE10.</figcaption></figure><h4 name="723e" id="723e" class="graf graf--h4 graf-after--figure">Outlook 2007–2016 support</h4><p name="1cda" id="1cda" class="graf graf--p graf-after--h4">An email technique wouldn’t be complete without specific code for the desktop versions of Outlook using Word’s rendering engine. Luckily, Outlook 2007–2016 support VML. So we can recreate the same background with the same logic, without any image. For this I used <a href="https://msdn.microsoft.com/en-us/library/bb264144%28v=vs.85%29.aspx#rect" data-href="https://msdn.microsoft.com/en-us/library/bb264144(v=vs.85).aspx#rect" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">VML </a><code class="markup--code markup--p-code"><a href="https://msdn.microsoft.com/en-us/library/bb264144%28v=vs.85%29.aspx#rect" data-href="https://msdn.microsoft.com/en-us/library/bb264144(v=vs.85).aspx#rect" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Rect</a></code><a href="https://msdn.microsoft.com/en-us/library/bb264144%28v=vs.85%29.aspx#rect" data-href="https://msdn.microsoft.com/en-us/library/bb264144(v=vs.85).aspx#rect" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"> elements</a> to create the different lines.</p><pre name="fbdc" id="fbdc" class="graf graf--pre graf-after--p">&lt;!--[if mso]&gt;<br>&lt;v:rect style=&quot;width:700px; height:5px;&quot; stroke=&quot;false&quot; fillcolor=&quot;#3b5998&quot;&gt;&lt;/v:rect&gt;<br>&lt;v:rect style=&quot;width:700px; height:5px;&quot; stroke=&quot;false&quot; fillcolor=&quot;#ffffff&quot;&gt;&lt;/v:rect&gt;<br>&lt;v:rect style=&quot;width:700px; height:5px;&quot; stroke=&quot;false&quot; fillcolor=&quot;#3b5998&quot;&gt;&lt;/v:rect&gt;<br>&lt;v:rect style=&quot;width:700px; height:5px;&quot; stroke=&quot;false&quot; fillcolor=&quot;#ffffff&quot;&gt;&lt;/v:rect&gt;<br>&lt;v:rect style=&quot;width:700px; height:5px;&quot; stroke=&quot;false&quot; fillcolor=&quot;#3b5998&quot;&gt;&lt;/v:rect&gt;<br>&lt;v:rect style=&quot;width:700px; height:5px;&quot; stroke=&quot;false&quot; fillcolor=&quot;#ffffff&quot;&gt;&lt;/v:rect&gt;<br>&lt;v:rect style=&quot;width:700px; height:5px;&quot; stroke=&quot;false&quot; fillcolor=&quot;#3b5998&quot;&gt;&lt;/v:rect&gt;<br>&lt;![endif]--&gt;</pre><p name="d081" id="d081" class="graf graf--p graf-after--pre">Then, each line will get its own <a href="https://msdn.microsoft.com/en-us/library/bb264147%28v=vs.85%29.aspx" data-href="https://msdn.microsoft.com/en-us/library/bb264147(v=vs.85).aspx" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">positioning</a> using CSS absolute positioning in VML. A <code class="markup--code markup--p-code">z-index</code> will place the pattern below our content.</p><pre name="3291" id="3291" class="graf graf--pre graf-after--p">&lt;v:rect style=&quot;position:absolute; top:10px; left:0; z-index:-1; width:700px; height:5px;&quot; stroke=&quot;false&quot; fillcolor=&quot;#3b5998&quot;&gt;&lt;/v:rect&gt;</pre><p name="fa81" id="fa81" class="graf graf--p graf-after--pre">And voilà!</p><figure name="dfbc" id="dfbc" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 303px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.3%;"></div><img class="graf-image" data-image-id="1*MqILpWmqAPPShWaTy6ZPZA.jpeg" data-width="1424" data-height="617" src="https://cdn-images-1.medium.com/max/800/1*MqILpWmqAPPShWaTy6ZPZA.jpeg"></div><figcaption class="imageCaption">The fake background working in Outlook 2016 on Email on Acid.</figcaption></figure><p name="0a7f" id="0a7f" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">(I’m not proud of that VML part. And I must admit I don’t know much about VML. So if know a better way to achieve this in VML, please let me know!)</em></p><h4 name="d5ce" id="d5ce" class="graf graf--h4 graf-after--p">Support</h4><p name="ef81" id="ef81" class="graf graf--p graf-after--h4">I’ve tested this thoroughly and I must say I’m pretty happy with the results. It works on Outlook.com. It works on GANGA. It works on La Poste and Free.</p><p name="5192" id="5192" class="graf graf--p graf-after--p">Out of the 91 devices and email clients proposed by Email on Acid, the only place where I’ve seen the fake background technique fails is in Lotus Notes 8. (It even works in Lotus Notes 8.5.) Nothing that couldn’t be enhanced with more code and conditional comments, but I left it as it is for now.</p><figure name="08f0" id="08f0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 364px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 52%;"></div><img class="graf-image" data-image-id="1*XuLvRXhoP8bWHNk0_Rr6cA.jpeg" data-width="1193" data-height="620" src="https://cdn-images-1.medium.com/max/800/1*XuLvRXhoP8bWHNk0_Rr6cA.jpeg"></div><figcaption class="imageCaption">The fake background failing in Lotus Notes 8.</figcaption></figure><p name="b964" id="b964" class="graf graf--p graf-after--figure">You can <a href="https://www.emailonacid.com/app/acidtest/display/summary/gcx8KOc0TwSTo4YyznQcDWaTNmcGNNxi22wrYcVALs4uB/shared" data-href="https://www.emailonacid.com/app/acidtest/display/summary/gcx8KOc0TwSTo4YyznQcDWaTNmcGNNxi22wrYcVALs4uB/shared" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">see the full test results from Email on Acid here</a>. <br>And you can <a href="https://gist.github.com/hteumeuleu/c65c701cf0de338df100938939cbd287" data-href="https://gist.github.com/hteumeuleu/c65c701cf0de338df100938939cbd287" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">get the code from this first example here</a>.</p><h3 name="ecc2" id="ecc2" class="graf graf--h3 graf-after--p">Fake background with a real image</h3><p name="6812" id="6812" class="graf graf--p graf-after--h3">Since the fake background technique uses HTML content as a background, this means we can use any HTML content, including <code class="markup--code markup--p-code">&lt;img&gt;</code> tags. Here’s an example.</p><pre name="4d92" id="4d92" class="graf graf--pre graf-after--p">&lt;div style=&quot;max-height:0; overflow:visible !important;&quot;&gt;<br>  &lt;img src=&quot;<a href="http://i.imgur.com/ZvweZV6.jpg" data-href="http://i.imgur.com/ZvweZV6.jpg" class="markup--anchor markup--pre-anchor" rel="nofollow noopener noopener" target="_blank">http://i.imgur.com/ZvweZV6.jpg</a>&quot; alt=&quot;&quot; style=&quot;display:block; width:100%; max-width:720px;&quot; /&gt;<br>&lt;/div&gt;</pre><p name="6188" id="6188" class="graf graf--p graf-after--pre">This means we can fake a background image that scales according to the device, even if <code class="markup--code markup--p-code">background-image</code> and <code class="markup--code markup--p-code">background-size</code> are not supported. I think this is a good concept for non repeating background images.</p><p name="e723" id="e723" class="graf graf--p graf-after--p">Here’s <a href="https://gist.github.com/hteumeuleu/2caa434cf46075bcdf60d65f710f6ac4" data-href="https://gist.github.com/hteumeuleu/2caa434cf46075bcdf60d65f710f6ac4" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">a demonstration of this concept</a> (and here’s <a href="https://www.emailonacid.com/app/acidtest/display/summary/COceELTuDSXSIftWDINihKu6yCXvOW0nLZjdC63N6FwS3/shared" data-href="https://www.emailonacid.com/app/acidtest/display/summary/COceELTuDSXSIftWDINihKu6yCXvOW0nLZjdC63N6FwS3/shared" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">a test in Email on Acid</a>).</p><figure name="edba" id="edba" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 282px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 40.2%;"></div><img class="graf-image" data-image-id="1*Ziky4yQnFg6j8uuVjlmHBg.jpeg" data-width="1492" data-height="600" src="https://cdn-images-1.medium.com/max/800/1*Ziky4yQnFg6j8uuVjlmHBg.jpeg"></div><figcaption class="imageCaption">The fake background with a real image on Outlook.com desktop and mobile.</figcaption></figure><p name="c1f0" id="c1f0" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">(This example doesn’t work yet in Outlook 2007–2016 for some reason. I’m working on it.)</em></p><p name="88a0" id="88a0" class="graf graf--p graf-after--p graf--trailing">We must still be careful with accessibility. Because our image is now in HTML, it will be picked up by screen readers. Depending on the context and the relevancy of the image, we might want to add <code class="markup--code markup--p-code">aria-hidden=&quot;true&quot;</code> on the <code class="markup--code markup--p-code">&lt;div&gt;</code> background container to hide it from screen readers.</p></div></div></section><section name="47ce" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="d88d" id="d88d" class="graf graf--p graf--leading graf--trailing">Let me know if you’ve tried this technique and found any shortcoming or any way to improve it.</p></div></div></section>
</section>