---
title:  "Today I learned about mso-generic-font-family…"
subtitle: "And solved a twelve years old Outlook mystery along the way."
date:   2019-07-17 20:56:55 +0200
---
<p>This morning I was doing some tests in Outlook on supported styles for HTML lists. And my focus quickly diverged to something completely unrelated. Using <a href="http://whatdoesitpaste.com/" rel="noopener" target="_blank"><em>What does it paste</em></a> for the first time to get the code generated by Outlook and its Word powered rendering engine, the <code>&lt;head&gt;</code> of the code contained the following:</p>

<pre><code>&lt;style&gt; &lt;!-- /* Font Definitions */<br>@font-face {<br> font-family:Calibri;<br> panose-1:2 15 5 2 2 2 4 3 2 4;<br> mso-font-charset:0;<br> mso-generic-font-family:swiss;<br> mso-font-pitch:variable;<br> mso-font-signature:-536859905 -1073732485 9 0 511 0;<br>}<br>&lt;/style&gt;</code></pre>

<p><code>@font-face</code>? In Outlook? How can that be?</p>

<p>If you’re familiar with web fonts in emails, you know there’s a notorious bug in <em>the Outlooks</em> (2007, 2010, 2013 and 2016) on Windows. Whenever you would import a web font using a <code>@font-face</code> declaration, Outlook would (as one can expect) disregard it. But Outlook would also disregard the font stack declared in your styles, forcing all texts using that web font to Times New Roman. Take the following example:</p>

<pre><code>&lt;!doctype html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br> &lt;title&gt;mso-generic-font-family&lt;/title&gt;<br> &lt;link href=&quot;https://fonts.googleapis.com/css?family=Pacifico&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br> &lt;p style=&quot;<strong>font-family:Pacifico, sans-serif;</strong>&quot;&gt;<br>  This is a text set in the &lt;strong&gt;Pacifico&lt;/strong&gt; font.<br> &lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</code></pre>

<p>Outlook would irremediably set that text in Times New Roman, ignoring the <code>sans-serif</code> fallback defined in the <code>font-family</code> property.</p>

<figure>
  <img src="https://cdn-images-1.medium.com/max/800/1*4UEFoZsSKJpG3yTPV8GbxQ.png">
  <figcaption>Tests screenshots from Email on Acid showing the text set in Times New Roman in Outlook 2016.</figcaption>
</figure>

<p>A lot of solutions surfaced through the years to avoid this bug, from <a href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" rel="noopener" target="_blank">using </a><code><a href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" rel="noopener" target="_blank">!important</a></code><a href="https://www.emailonacid.com/blog/article/email-development/custom-font-stacks-in-outlook/" rel="noopener" target="_blank"> inline</a> to <a href="https://www.campaignmonitor.com/blog/email-marketing/2019/04/using-web-fonts-in-email/" rel="noopener" target="_blank">setting your web font inside a media query</a>. But my favorite has always been to hide the web font inclusion from Outlook using a conditional comment like in the following example.</p>

<pre><code>&lt;!--[if !mso]&gt;&lt;!-- --&gt;<br>&lt;link href=&quot;https://fonts.googleapis.com/css?family=Pacifico&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;<br>&lt;!--&lt;![endif]--&gt;</code></pre>

<p>I always felt that this Outlook behavior was very weird, even by Outlook standards. But that solution worked well enough for me that I never bothered digging any further. Plus, that bug was <a href="https://litmus.com/blog/microsoft-outlook-2019-heres-whats-new" rel="noopener" target="_blank">fixed in the latest Outlook 2019</a> release, so that case was closed for me. Or so I thought.</p><p>When I saw that <code>@font-face</code> declaration added by Outlook this morning, I knew there was something more to it. The following line especially piqued my interest:</p>

<pre><code>mso-generic-font-family:swiss;</code></pre>

<p>I had never ever heard of that property. But that name really sounds like it could play a role in Outlook’s fallback behavior for web fonts.</p>

<p>So I took my first test example, declared my web font in an embedded style tag, and added that <code>mso-generic-font-family</code> property.</p>

<pre><code>&lt;!doctype html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br> &lt;title&gt;mso-generic-font-family&lt;/title&gt;<br> &lt;style&gt;<br> @font-face {<br>   font-family: &#39;Pacifico&#39;;<br>   font-style: normal;<br>   font-weight: 400;<br>   src: local(&#39;Pacifico Regular&#39;), local(&#39;Pacifico-Regular&#39;), url(https://www.caniemail.com/tests/assets/fonts/pacifico-regular.woff2) format(&#39;woff2&#39;);<br>   <strong>mso-generic-font-family:swiss;</strong><br> }<br> &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br> &lt;p style=&quot;font-family:Pacifico, sans-serif;&quot;&gt;<br>  This is a text set in the &lt;strong&gt;Pacifico&lt;/strong&gt; font.<br> &lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</code></pre>

<p>And voilà!</p>

<figure>
  <img src="https://cdn-images-1.medium.com/max/800/1*UPlOh0CIdav98xzBZWJjkw.png">
  <figcaption>Tests screenshots from Email on Acid showing the text set in Arial in Outlook 2016.</figcaption>
</figure>

<p>The <code>mso-generic-font-family</code> property accepts the following values:</p>
<ul>
  <li><code>decorative</code></li>
  <li><code>modern</code></li>
  <li><code>roman</code> (akin to serif)</li>
  <li><code>script</code></li>
  <li><code>swiss</code> (akin to sans-serif)</li>
  <li><code>auto</code> (defined to <code>roman</code> by default)</li>
</ul>

<p>This explains it all. Outlook does support <code>@font-face</code> declarations (but doesn’t load distant fonts). Because Outlook can’t display that font, it falls back to its expected <code>mso-generic-font-family</code> value. And because it’s not defined, it falls back to its <code>auto</code> value, matching the <code>roman</code> font family, thus falling back to Times New Roman.</p>
<p>Case solved.</p>

<hr>

<p>Digging a little bit further through codes generated by Outlook and <a href="https://rodriguezcommaj.com/blog/dial-ed-for-mso" rel="noopener" target="_blank">Microsoft’s Office HTML reference</a>, I also stumbled on a property named <code>mso-font-alt</code>. This property allows for even more fine tuning for web fonts fallback in Outlook as it can accept another font name. So if we add the following lines to our <code>@font-face</code> declaration, Outlook will first try to apply the font named in the <code>mso-font-alt</code> property (if it’s installed on the machine) and apply the family defined in <code>mso-generic-font-family</code> otherwise.</p>

<pre><code>mso-generic-font-family: swiss;<br>mso-font-alt: &quot;Century Gothic&quot;;</code></pre>

<hr>

<p>I hope you enjoyed this read as much as I enjoyed doing this research. I’m now wondering if there’s more to <code>@font-face</code> in Outlook than this. Could there be a way to actually get distant fonts loaded in Outlook? Let me know if you know or find out anything about this.</p>